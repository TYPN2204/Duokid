<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="'BÃ i kiá»ƒm tra: ' + ${test.title}">BÃ i kiá»ƒm tra</title>
    <link rel="stylesheet" th:href="@{/styles.css}">
    <script src="/grade-dropdown.js" defer></script>
</head>
<body>
<div class="layout">
    <header class="top-nav">
        <div class="logo">duokid</div>
        <nav>
            <a th:href="@{/dashboard}">ğŸ  Há»ŒC</a>
            <span class="menu-divider"></span>
            <div class="grade-dropdown">
                <span class="grade-dropdown-trigger">ğŸ“š Lá»›p há»c</span>
                <div class="grade-dropdown-menu">
                    <a th:href="@{/grade/GRADE1}">Lá»›p 1</a>
                    <a th:href="@{/grade/GRADE2}">Lá»›p 2</a>
                    <a th:href="@{/grade/GRADE3}">Lá»›p 3</a>
                    <a th:href="@{/grade/GRADE4}">Lá»›p 4</a>
                    <a th:href="@{/grade/GRADE5}">Lá»›p 5</a>
                </div>
            </div>
            <span class="menu-divider"></span>
            <a th:href="@{/mywords}">ğŸ“ Sá»• tay</a>
            <a th:href="@{/vocabulary}">ğŸ“š Tá»« vá»±ng</a>
            <a th:href="@{/practice}">ğŸ”„ Ã”n táº­p</a>
            <a th:href="@{/minigame}">ğŸ® Mini game</a>
            <a th:href="@{/tests}" class="active">ğŸ“ BÃ i kiá»ƒm tra</a>
            <a th:href="@{/leaderboard}">ğŸ† Báº£ng xáº¿p háº¡ng</a>
            <a th:href="@{/shop}">ğŸ›’ Cá»­a hÃ ng</a>
            <a th:href="@{/chat}">ğŸ’¬ Chat</a>
            <a th:href="@{/profile}">ğŸ‘¤ Há»“ sÆ¡</a>
            <span class="menu-divider"></span>
            <a th:href="@{/logout}">ğŸšª ÄÄƒng xuáº¥t</a>
        </nav>
    </header>
    <main class="main">
        <div class="lesson-header">
            <h1>ğŸ“ <span th:text="${test.title}">BÃ i kiá»ƒm tra</span></h1>
            <div class="stats-bar" style="max-width: 400px;">
                <div class="stat-item">
                    <span class="stat-icon">â¤ï¸</span>
                    <span>Tim: <b th:text="${user.hearts}">5</b></span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">âš¡</span>
                    <span>XP: <b th:text="${user.xp}">0</b></span>
                </div>
            </div>
        </div>
        
        <div class="panel" style="background: #FEF3C7; border: 2px solid #F59E0B; margin: 20px 0;">
            <h3 style="color: #92400E;">âš ï¸ LÆ°u Ã½ quan trá»ng:</h3>
            <ul style="color: #92400E; line-height: 1.8;">
                <li>BÃ i kiá»ƒm tra nÃ y xuáº¥t hiá»‡n sau khi báº¡n hoÃ n thÃ nh <strong th:text="${test.afterLessons}">5</strong> bÃ i há»c</li>
                <li>Äiá»ƒm Ä‘áº¡t: <strong th:text="${test.passingScore}">70</strong>/100</li>
                <li>Náº¿u Ä‘áº¡t Ä‘iá»ƒm: Nháº­n <strong th:text="${test.xpReward}">20</strong> XP vÃ  <strong th:text="${test.gemsReward}">10</strong> Gems</li>
                <li>Náº¿u khÃ´ng Ä‘áº¡t: Máº¥t <strong th:text="${test.heartsLostOnFail}">1</strong> tim â¤ï¸</li>
            </ul>
        </div>

        <div th:if="${test.instructions}" class="panel" style="margin: 20px 0;">
            <h3>ğŸ“‹ HÆ°á»›ng dáº«n:</h3>
            <p th:utext="${test.instructions}"></p>
        </div>

        <form th:action="@{'/test/' + ${test.id} + '/submit'}" method="post" class="quiz-form">
            <div class="quiz-question" th:each="q,iter : ${questions}">
                <h3 th:text="${iter.index + 1} + '. ' + ${q.question}">CÃ¢u há»i</h3>
                <label class="quiz-option">
                    <input type="radio" th:name="${'answer_' + q.id}" value="A" required> 
                    <span><strong>A.</strong> <span th:text="${q.optionA}"></span></span>
                </label>
                <label class="quiz-option">
                    <input type="radio" th:name="${'answer_' + q.id}" value="B"> 
                    <span><strong>B.</strong> <span th:text="${q.optionB}"></span></span>
                </label>
                <label class="quiz-option">
                    <input type="radio" th:name="${'answer_' + q.id}" value="C"> 
                    <span><strong>C.</strong> <span th:text="${q.optionC}"></span></span>
                </label>
                <label class="quiz-option">
                    <input type="radio" th:name="${'answer_' + q.id}" value="D"> 
                    <span><strong>D.</strong> <span th:text="${q.optionD}"></span></span>
                </label>
                <hr style="margin: 20px 0;">
            </div>
            <button type="submit" class="btn-main big" style="width: 100%; margin-top: 20px;">
                âœ… Ná»™p bÃ i kiá»ƒm tra
            </button>
        </form>
    </main>
</div>
<style>
.quiz-option {
    display: block;
    padding: 12px;
    margin: 8px 0;
    background: #F9FAFB;
    border: 2px solid #E5E7EB;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.quiz-option:hover {
    background: #F3F4F6;
    border-color: #58CC02;
}

.quiz-option input[type="radio"] {
    margin-right: 10px;
    cursor: pointer;
}

.quiz-option input[type="radio"]:checked + span {
    color: #059669;
    font-weight: 600;
}

.quiz-question {
    margin: 30px 0;
    padding: 20px;
    background: #FFFFFF;
    border-radius: 12px;
    border: 2px solid #E5E7EB;
}

.quiz-question h3 {
    color: #1F2937;
    margin-bottom: 15px;
    font-size: 18px;
}
</style>
</body>
</html>

