<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Báº£ng xáº¿p háº¡ng</title>
    <link rel="stylesheet" th:href="@{/styles.css}">
    <script src="/grade-dropdown.js" defer></script>
</head>
<body>
<div class="layout">
    <header class="top-nav">
        <div class="logo">duokid</div>
        <nav>
            <a th:href="@{/dashboard}">ğŸ  Há»ŒC</a>
            <span class="menu-divider"></span>
            <div class="grade-dropdown">
                <span class="grade-dropdown-trigger">ğŸ“š Lá»›p há»c</span>
                <div class="grade-dropdown-menu">
                    <a th:href="@{/grade/GRADE1}">Lá»›p 1</a>
                    <a th:href="@{/grade/GRADE2}">Lá»›p 2</a>
                    <a th:href="@{/grade/GRADE3}">Lá»›p 3</a>
                    <a th:href="@{/grade/GRADE4}">Lá»›p 4</a>
                    <a th:href="@{/grade/GRADE5}">Lá»›p 5</a>
                </div>
            </div>
            <span class="menu-divider"></span>
            <a th:href="@{/mywords}">ğŸ“ Sá»• tay</a>
            <a th:href="@{/vocabulary}">ğŸ“š Tá»« vá»±ng</a>
            <a th:href="@{/practice}">ğŸ”„ Ã”n táº­p</a>
            <a th:href="@{/minigame}">ğŸ® Mini game</a>
            <a th:href="@{/leaderboard}" class="active">ğŸ† Báº£ng xáº¿p háº¡ng</a>
            <a th:href="@{/shop}">ğŸ›’ Cá»­a hÃ ng</a>
            <a th:href="@{/chat}">ğŸ’¬ Chat</a>
            <a th:href="@{/profile}">ğŸ‘¤ Há»“ sÆ¡</a>
            <span class="menu-divider"></span>
            <a th:href="@{/logout}">ğŸšª ÄÄƒng xuáº¥t</a>
        </nav>
    </header>
    <main class="main">
        <!-- Locked State -->
        <div th:if="${locked}" class="panel" style="text-align: center; max-width: 500px; margin: 40px auto;">
            <div style="font-size: 64px; margin-bottom: 20px;">ğŸ”’</div>
            <h1>Má»Ÿ khÃ³a Báº£ng xáº¿p háº¡ng!</h1>
            <p style="font-size: 16px; color: #6B7280; margin: 20px 0;">
                HoÃ n thÃ nh thÃªm <strong th:text="${requiredLessons - completedLessons}">10</strong> bÃ i há»c Ä‘á»ƒ báº¯t Ä‘áº§u thi Ä‘ua
            </p>
            <div style="margin: 30px 0;">
                <div style="font-size: 48px; font-weight: 700; color: #58CC02;" th:text="${completedLessons}">0</div>
                <div style="color: #6B7280;">/ <span th:text="${requiredLessons}">10</span> bÃ i há»c</div>
            </div>
            <div class="quest-progress-bar" style="max-width: 300px; margin: 20px auto;">
                <div class="quest-progress-fill" 
                     th:style="'width: ' + (${completedLessons} * 100.0 / ${requiredLessons}) + '%'">
                </div>
            </div>
            <a th:href="@{/dashboard}" class="btn-main" style="margin-top: 20px; display: inline-block;">
                Tiáº¿p tá»¥c há»c
            </a>
        </div>

        <!-- Unlocked State -->
        <div th:if="${!locked}">
            <h1>Báº£ng xáº¿p háº¡ng</h1>
            <p>Top 10 há»c sinh cÃ³ XP cao nháº¥t.</p>
            <table class="leaderboard-table">
                <thead>
                <tr>
                    <th>Háº¡ng</th>
                    <th>Há»c sinh</th>
                    <th>XP</th>
                    <th>Gems</th>
                    <th>Streak</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="u,iter : ${topUsers}"
                    th:classappend="${user.id == u.id} ? 'me-row'">
                    <td th:text="${iter.index + 1}">1</td>
                    <td>
                        <span th:text="${u.displayName}">TÃªn</span>
                        <span th:if="${user.id == u.id}"> (báº¡n)</span>
                    </td>
                    <td th:text="${u.xp}">0</td>
                    <td>ğŸ’ <span th:text="${u.gems}">500</span></td>
                    <td>ğŸ”¥ <span th:text="${u.streak}">0</span></td>
                </tr>
                </tbody>
            </table>
        </div>
    </main>
</div>
</body>
</html>
