<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Mini game luyá»‡n tá»« vá»±ng</title>
    <link rel="stylesheet" th:href="@{/styles.css}">
    <script src="/grade-dropdown.js" defer></script>
</head>
<body>
<div class="layout">
    <header class="top-nav">
        <div class="logo">duokid</div>
        <nav>
            <a th:href="@{/dashboard}">ğŸ  Há»ŒC</a>
            <span class="menu-divider"></span>
            <div class="grade-dropdown">
                <span class="grade-dropdown-trigger">ğŸ“š Lá»›p há»c</span>
                <div class="grade-dropdown-menu">
                    <a th:href="@{/grade/GRADE1}">Lá»›p 1</a>
                    <a th:href="@{/grade/GRADE2}">Lá»›p 2</a>
                    <a th:href="@{/grade/GRADE3}">Lá»›p 3</a>
                    <a th:href="@{/grade/GRADE4}">Lá»›p 4</a>
                    <a th:href="@{/grade/GRADE5}">Lá»›p 5</a>
                </div>
            </div>
            <span class="menu-divider"></span>
            <a th:href="@{/mywords}">ğŸ“ Sá»• tay</a>
            <a th:href="@{/vocabulary}">ğŸ“š Tá»« vá»±ng</a>
            <a th:href="@{/practice}">ğŸ”„ Ã”n táº­p</a>
            <a th:href="@{/minigame}" class="active">ğŸ® Mini game</a>
            <a th:href="@{/tests}">ğŸ“ BÃ i kiá»ƒm tra</a>
            <a th:href="@{/leaderboard}">ğŸ† Báº£ng xáº¿p háº¡ng</a>
            <a th:href="@{/shop}">ğŸ›’ Cá»­a hÃ ng</a>
            <a th:href="@{/chat}">ğŸ’¬ Chat</a>
            <a th:href="@{/profile}">ğŸ‘¤ Há»“ sÆ¡</a>
            <span class="menu-divider"></span>
            <a th:href="@{/logout}">ğŸšª ÄÄƒng xuáº¥t</a>
        </nav>
    </header>
    <main class="main">
        <div style="text-align: center; margin-bottom: 30px;">
            <h1>Mini game luyá»‡n tá»« vá»±ng</h1>
            <p>Chá»n má»™t trong cÃ¡c game Ä‘á»ƒ báº¯t Ä‘áº§u luyá»‡n táº­p tá»« vá»±ng!</p>
            
            <!-- Game Selection Cards -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; margin-top: 40px; max-width: 1100px; margin-left: auto; margin-right: auto; padding: 0 20px;">
                <!-- Game 1: NhÃ¬n hÃ¬nh chá»n tá»« -->
                <div class="panel" style="padding: 40px; text-align: center; background: linear-gradient(135deg, #FFFFFF 0%, #F0FDF4 100%); border: 3px solid #58CC02; box-shadow: 0 10px 30px rgba(88, 204, 2, 0.2); transition: transform 0.3s ease;">
                    <div style="font-size: 80px; margin-bottom: 20px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));">ğŸ–¼ï¸</div>
                    <h3 style="margin-bottom: 12px; font-size: 24px; font-weight: 800; color: #1F2937;">NhÃ¬n hÃ¬nh chá»n tá»«</h3>
                    <p style="color: #6B7280; margin-bottom: 25px; font-size: 15px; line-height: 1.6;">
                        Xem hÃ¬nh áº£nh vÃ  chá»n tá»« vá»±ng Ä‘Ãºng.<br>
                        <strong style="color: #58CC02;">Má»—i cÃ¢u Ä‘Ãºng +10 Ä‘iá»ƒm, thÆ°á»Ÿng 5 XP</strong>
                    </p>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <a th:href="@{/minigame?category=Personal}" class="btn-main" style="width: 100%; background: #58CC02; border-color: #58CC02; font-size: 18px; padding: 16px; font-weight: 700; box-shadow: 0 4px 12px rgba(88, 204, 2, 0.3);">
                            ğŸ® ChÆ¡i ngay
                        </a>
                        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-top: 10px;">
                            <a th:href="@{/minigame?category=Personal}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Personal</a>
                            <a th:href="@{/minigame?category=Animals}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Animals</a>
                            <a th:href="@{/minigame?category=Colors}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Colors</a>
                            <a th:href="@{/minigame?category=Food}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Food</a>
                        </div>
                    </div>
                </div>

                <!-- Game 2: NhÃ¬n hÃ¬nh ghÃ©p tá»« -->
                <div class="panel" style="padding: 40px; text-align: center; background: linear-gradient(135deg, #FFFFFF 0%, #EFF6FF 100%); border: 3px solid #3B82F6; box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2); transition: transform 0.3s ease;">
                    <div style="font-size: 80px; margin-bottom: 20px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));">ğŸ§©</div>
                    <h3 style="margin-bottom: 12px; font-size: 24px; font-weight: 800; color: #1F2937;">NhÃ¬n hÃ¬nh ghÃ©p tá»«</h3>
                    <p style="color: #6B7280; margin-bottom: 25px; font-size: 15px; line-height: 1.6;">
                        Xem hÃ¬nh áº£nh vÃ  ghÃ©p cÃ¡c chá»¯ cÃ¡i thÃ nh tá»« vá»±ng Ä‘Ãºng.<br>
                        <strong style="color: #3B82F6;">Má»—i cÃ¢u Ä‘Ãºng +15 Ä‘iá»ƒm, thÆ°á»Ÿng 8 XP</strong>
                    </p>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <a th:href="@{/minigame?gameType=puzzle&category=Personal}" class="btn-main" style="width: 100%; background: #3B82F6; border-color: #3B82F6; font-size: 18px; padding: 16px; font-weight: 700; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
                            ğŸ® ChÆ¡i ngay
                        </a>
                        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-top: 10px;">
                            <a th:href="@{/minigame?gameType=puzzle&category=Personal}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Personal</a>
                            <a th:href="@{/minigame?gameType=puzzle&category=Animals}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Animals</a>
                            <a th:href="@{/minigame?gameType=puzzle&category=Colors}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Colors</a>
                            <a th:href="@{/minigame?gameType=puzzle&category=Food}" class="btn-main" style="padding: 10px 18px; font-size: 13px; background: #E0F2FE; color: #1E40AF; border-color: #3B82F6; border-width: 2px;">Food</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-layout">
            <div class="panel">
                <h3>VÃ²ng chÆ¡i hiá»‡n táº¡i</h3>
                <form th:action="@{/minigame/submit}" method="post" class="game-form">
                    <div class="game-question" th:each="q,iter : ${questions}">
                        <input type="hidden" name="questionIds" th:value="${q.id}">
                        <p class="gq-title" th:text="${iter.index + 1} + '. ' + ${q.prompt}">CÃ¢u há»i</p>
                        <div class="gq-options">
                            <label th:each="opt : ${q.options}">
                                <input type="radio"
                                       th:name="${'answer_' + q.id}"
                                       th:value="${opt}"
                                       required>
                                <span th:text="${opt}">Option</span>
                            </label>
                        </div>
                    </div>
                    <button type="submit" class="btn-main big">Ná»™p káº¿t quáº£</button>
                </form>
                <div class="game-result" th:if="${gamePoints != null}">
                    <p><strong>Äiá»ƒm vÃ²ng nÃ y:</strong> <span th:text="${gamePoints}">0</span> Ä‘iá»ƒm</p>
                    <p><strong>Sá»‘ cÃ¢u Ä‘Ãºng:</strong> <span th:text="${gameCorrect}">0</span>/<span th:text="${gameTotal}">5</span></p>
                    <p><strong>XP nháº­n Ä‘Æ°á»£c:</strong> +<span th:text="${gameXp}">0</span> âš¡</p>
                    <p><strong>Ká»· lá»¥c cá»§a báº¡n:</strong> <span th:text="${gameBest}">0</span> Ä‘iá»ƒm</p>
                </div>
            </div>

            <div class="panel">
                <h3>ğŸ… Báº£ng xáº¿p háº¡ng mini game</h3>
                <table class="leaderboard-table">
                    <thead>
                    <tr>
                        <th>Háº¡ng</th>
                        <th>Há»c sinh</th>
                        <th>Äiá»ƒm tÃ­ch lÅ©y</th>
                        <th>Best vÃ²ng</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="score,iter : ${leaderboard}"
                        th:classappend="${user.id == score.user.id} ? 'me-row'">
                        <td th:text="${iter.index + 1}">1</td>
                        <td th:text="${score.user.displayName}">TÃªn</td>
                        <td th:text="${score.totalPoints}">0</td>
                        <td th:text="${score.bestRoundScore}">0</td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(leaderboard)}">
                        <td colspan="4">ChÆ°a cÃ³ ai tham gia. HÃ£y lÃ  ngÆ°á»i Ä‘áº§u tiÃªn!</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</div>
</body>
</html>

